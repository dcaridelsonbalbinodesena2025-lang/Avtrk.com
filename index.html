<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>K.cğŸš€m / Aridelson B.ğŸš€</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        :root { --tg-bg: #0e1621; --tg-panel: #17212b; --tg-blue: #2481cc; --tg-green: #45ad5b; --tg-text: #f5f5f5; }
        body { background: #070a0e; color: var(--tg-text); font-family: 'Open Sans', sans-serif; margin: 0; display: flex; justify-content: center; height: 100vh; overflow: hidden; }
        #app { width: 100%; max-width: 450px; background: var(--tg-bg); display: flex; flex-direction: column; position: relative; border-left: 1px solid #222; border-right: 1px solid #222; }
        .tg-header { background: var(--tg-panel); padding: 12px 15px; display: flex; align-items: center; border-bottom: 1px solid #000; }
        .tg-avatar { width: 42px; height: 42px; background: linear-gradient(135deg, #50a2e3, #2481cc); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: bold; margin-right: 12px; }
        .tg-info { flex: 1; }
        .tg-info b { display: block; font-size: 14px; }
        .tg-info span { font-size: 11px; color: var(--tg-green); }
        .visor-chat { flex-grow: 1; padding: 15px; overflow-y: auto; display: flex; flex-direction: column; background-image: url('https://user-images.githubusercontent.com/15075759/28719144-86dc0f70-73b1-11e7-911d-60d70fcded21.png'); background-blend-mode: overlay; background-color: var(--tg-bg); }
        .bubble { max-width: 90%; padding: 12px; border-radius: 12px; margin-bottom: 15px; font-size: 14px; align-self: flex-start; background: var(--tg-panel); box-shadow: 0 1px 3px rgba(0,0,0,0.4); line-height: 1.6; position: relative; }
        .admin-tag { color: #6c7883; font-size: 11px; float: right; }
        .btn-corretora { background: #45ad5b; color: white; text-align: center; padding: 10px; border-radius: 5px; text-decoration: none; display: block; margin-top: 5px; font-weight: bold; text-transform: uppercase; font-size: 12px; }
        #panel-config { display: none; position: absolute; top: 65px; left: 10px; right: 10px; background: var(--tg-panel); padding: 20px; border-radius: 12px; z-index: 200; border: 1px solid #333; max-height: 80vh; overflow-y: auto; }
        .config-row { margin-bottom: 12px; }
        .config-row label { font-size: 11px; color: var(--tg-blue); font-weight: bold; display: block; margin-bottom: 4px; }
        .config-row select, .config-row input { width: 100%; background: #0e1621; color: #fff; border: 1px solid #333; padding: 10px; border-radius: 6px; font-size: 13px; }
        .tg-footer { background: var(--tg-panel); padding: 10px; border-top: 1px solid #000; display: flex; justify-content: space-around; }
        .btn-footer { background: none; border: none; color: #6c7883; cursor: pointer; text-align: center; font-size: 10px; }
    </style>
</head>
<body>

<div id="app">
    <div class="tg-header">
        <div class="tg-avatar">KC</div>
        <div class="tg-info"><b>K.cğŸš€m / Aridelson B.ğŸš€</b><span id="status-global">desconectado</span></div>
        <div style="text-align: right;">
            <div id="placar-header" style="font-size: 11px; font-weight: bold;">ğŸŸ¢ 0 | ğŸ”´ 0</div>
            <div id="banca-header" style="font-size: 10px; color: var(--tg-green);">R$ 0.00</div>
        </div>
    </div>

    <div class="visor-chat" id="chat"></div>

    <div id="panel-config">
        <div class="config-row"><label>BANCA INICIAL (R$)</label><input type="number" id="inpBanca" value="5000"></div>
        <div class="config-row"><label>ESTRATÃ‰GIA</label><select id="selEstrat"><option value="REGRA 1">REGRA 1</option><option value="FLUXO">FLUXO</option></select></div>
        <div class="config-row"><label>SLOT 1</label><select id="selAtivo1" class="sel-ativo"></select></div>
        <div class="config-row"><label>SLOT 2</label><select id="selAtivo2" class="sel-ativo"></select></div>
        <div class="config-row"><label>SLOT 3</label><select id="selAtivo3" class="sel-ativo"></select></div>
        <button onclick="salvarConfig()" style="width: 100%; padding: 15px; background: var(--tg-blue); color: white; border: none; border-radius: 6px; font-weight: bold;">LIGAR MONITORAMENTO REAL</button>
    </div>

    <div class="tg-footer">
        <button class="btn-footer" onclick="toggleConfig()"><i class="fas fa-cog fa-2x"></i><br>AJUSTES</button>
        <button class="btn-footer" onclick="location.reload()"><i class="fas fa-sync fa-2x"></i><br>REINICIAR</button>
    </div>
</div>

<script>
    const LISTA_ATIVOS = [
        { id: "NONE", nome: "âŒ DESATIVAR SLOT" },
        { id: "1HZ10V", nome: "ğŸ“ˆ Volatility 10 (1s)" },
        { id: "1HZ25V", nome: "ğŸ“ˆ Volatility 25 (1s)" },
        { id: "1HZ50V", nome: "ğŸ“ˆ Volatility 50 (1s)" },
        { id: "1HZ75V", nome: "ğŸ“ˆ Volatility 75 (1s)" },
        { id: "1HZ100V", nome: "ğŸ“ˆ Volatility 100 (1s)" },
        { id: "R_10", nome: "ğŸ“Š Volatility 10" },
        { id: "R_25", nome: "ğŸ“Š Volatility 25" },
        { id: "R_50", nome: "ğŸ“Š Volatility 50" },
        { id: "R_75", nome: "ğŸ“Š Volatility 75" },
        { id: "R_100", nome: "ğŸ“Š Volatility 100" },
        { id: "JD10", nome: "ğŸš€ Jump 10" },
        { id: "JD25", nome: "ğŸš€ Jump 25" },
        { id: "JD50", nome: "ğŸš€ Jump 50" },
        { id: "JD75", nome: "ğŸš€ Jump 75" },
        { id: "JD100", nome: "ğŸš€ Jump 100" },
        { id: "BOOM300", nome: "ğŸ’¥ Boom 300" },
        { id: "BOOM500", nome: "ğŸ’¥ Boom 500" },
        { id: "BOOM1000", nome: "ğŸ’¥ Boom 1000" },
        { id: "CRASH300", nome: "ğŸ“‰ Crash 300" },
        { id: "CRASH500", nome: "ğŸ“‰ Crash 500" },
        { id: "CRASH1000", nome: "ğŸ“‰ Crash 1000" },
        { id: "ST50", nome: "ğŸ¢ Step Index" },
        { id: "frxEURUSD", nome: "ğŸ’± EUR/USD (Euro/DÃ³lar)" },
        { id: "frxGBPUSD", nome: "ğŸ’± GBP/USD (Libra/DÃ³lar)" },
        { id: "frxUSDJPY", nome: "ğŸ’± USD/JPY (DÃ³lar/Iene)" },
        { id: "frxAUDUSD", nome: "ğŸ’± AUD/USD (DÃ³lar Aus./DÃ³lar)" },
        { id: "frxUSDCAD", nome: "ğŸ’± USD/CAD (DÃ³lar/DÃ³lar Can.)" },
        { id: "frxUSDCHF", nome: "ğŸ’± USD/CHF (DÃ³lar/Franco SuÃ­Ã§o)" },
        { id: "frxEURGBP", nome: "ğŸ’± EUR/GBP (Euro/Libra)" },
        { id: "frxEURJPY", nome: "ğŸ’± EUR/JPY (Euro/Iene)" },
        { id: "frxGBPJPY", nome: "ğŸ’± GBP/JPY (Libra/Iene)" },
        { id: "frxXAUUSD", nome: "ğŸª™ OURO (XAU/USD)" },
        { id: "frxXAGUSD", nome: "ğŸ¥ˆ PRATA (XAG/USD)" },
        { id: "cryBTCUSD", nome: "â‚¿ BITCOIN (BTC/USD)" },
        { id: "cryETHUSD", nome: "â™¢ ETHEREUM (ETH/USD)" }
    ];

    let sockets = [], banca = 0, wins = 0, loss = 0, operando = false;
    let dadosMercado = {}; 

    function popularAtivos() {
        document.querySelectorAll('.sel-ativo').forEach(sel => {
            LISTA_ATIVOS.forEach(a => { sel.innerHTML += `<option value="${a.id}">${a.nome}</option>`; });
        });
    }

    function addMsg(conteudo) {
        const chat = document.getElementById('chat');
        const div = document.createElement('div');
        div.className = 'bubble';
        const hora = new Date().toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'});
        div.innerHTML = `<span class="admin-tag">admin</span><b style="color:#e67e22">K.cğŸš€m / Aridelson B.ğŸš€</b><br>${conteudo}<br><small style="opacity:0.5; float:right">${hora}</small><div style="clear:both"></div><a href="#" class="btn-corretora">ğŸ“± ACESSAR CORRETORA</a>`;
        chat.appendChild(div); chat.scrollTop = chat.scrollHeight;
    }

    function toggleConfig() { document.getElementById('panel-config').style.display = 'block'; }

    function salvarConfig() {
        banca = parseFloat(document.getElementById('inpBanca').value);
        document.getElementById('banca-header').innerText = `R$ ${banca.toFixed(2)}`;
        document.getElementById('panel-config').style.display = 'none';
        conectarMercado();
    }

    function conectarMercado() {
        sockets.forEach(s => s.close());
        sockets = []; dadosMercado = {};
        
        const ativosSelecionados = [
            document.getElementById('selAtivo1').value,
            document.getElementById('selAtivo2').value,
            document.getElementById('selAtivo3').value
        ].filter(id => id !== "NONE");

        const totalAtivos = ativosSelecionados.length;

        ativosSelecionados.forEach(id => {
            const ws = new WebSocket('wss://ws.binaryws.com/websockets/v3?app_id=1');
            ws.onopen = () => ws.send(JSON.stringify({ ticks: id }));
            ws.onmessage = (m) => {
                const d = JSON.parse(m.data);
                if (d.tick) motorAnalise(id, d.tick.quote);
            };
            sockets.push(ws);
        });

        document.getElementById('status-global').innerText = "VIGILÃ‚NCIA ATIVA";
        addMsg(`<b>SISTEMA LIGADO</b><br>Monitorando ${totalAtivos} ${totalAtivos === 1 ? 'ativo' : 'ativos'} em tempo real.`);
    }

    function motorAnalise(id, preco) {
        if (!dadosMercado[id]) dadosMercado[id] = { atual: preco, abertura: preco, ultimaMsg: 0 };
        dadosMercado[id].atual = preco;
        const agora = Date.now();
        const seg = new Date().getSeconds();

        if (seg === 0) dadosMercado[id].abertura = preco;

        if (!operando && dadosMercado[id].abertura > 0) {
            let diff = ((preco - dadosMercado[id].abertura) / dadosMercado[id].abertura) * 100;
            if (Math.abs(diff) > 0.015 && (agora - dadosMercado[id].ultimaMsg > 40000)) {
                dadosMercado[id].ultimaMsg = agora;
                const nomeAtivo = LISTA_ATIVOS.find(a => a.id === id).nome;
                iniciarSinal(id, nomeAtivo, diff > 0 ? "VENDA" : "CALL");
            }
        }
    }

    function iniciarSinal(id, nome, dir, gale = 0) {
        operando = true;
        const entradaPreco = dadosMercado[id].atual;
        if (gale === 0) {
            const hPrev = new Date(Date.now() + 2000).toLocaleTimeString([], {hour:'2-digit', minute:'2-digit', second:'00'});
            addMsg(`ğŸ” <b>ALERTA DE SINAL</b><br><br>ğŸ“Š Ativo: ${nome}<br>ğŸ¯ DireÃ§Ã£o: ${dir}<br>â° Entrada prevista: ${hPrev}`);
        }

        setTimeout(() => {
            const hIn = new Date().toLocaleTimeString();
            const hFim = new Date(Date.now() + 60000).toLocaleTimeString();
            addMsg(`${gale > 0 ? 'ğŸ”„ <b>ENTRADA GALE '+gale+'</b>' : 'ğŸš€ <b>ENTRADA CONFIRMADA</b>'}<br><br>ğŸ“Š Ativo: ${nome}<br>ğŸ¯ DireÃ§Ã£o: ${dir === 'CALL' ? 'COMPRA ğŸŸ¢' : 'VENDA ğŸ”´'}<br>ğŸ•’ InÃ­cio: ${hIn}<br>ğŸ Fim: ${hFim}`);

            setTimeout(() => {
                const saidaPreco = dadosMercado[id].atual;
                const win = (dir === "CALL" ? saidaPreco > entradaPreco : saidaPreco < entradaPreco);
                
                if (win) {
                    wins++; banca += 9.5;
                    addMsg(`âœ… <b>RESULTADO: GREEN</b><br><br>ğŸ“Š Ativo: ${nome}<br>ğŸ“ˆ Placar: ğŸŸ¢ ${wins}W | ğŸ”´ ${loss}L`);
                    operando = false;
                } else if (gale < 2) {
                    iniciarSinal(id, nome, dir, gale + 1);
                } else {
                    loss++; banca -= 10;
                    addMsg(`âŒ <b>RESULTADO: RED</b><br><br>ğŸ“Š Ativo: ${nome}<br>ğŸ“ˆ Placar: ğŸŸ¢ ${wins}W | ğŸ”´ ${loss}L`);
                    operando = false;
                }
                document.getElementById('placar-header').innerText = `ğŸŸ¢ ${wins} | ğŸ”´ ${loss}`;
                document.getElementById('banca-header').innerText = `R$ ${banca.toFixed(2)}`;
            }, 60000);
        }, gale === 0 ? 2000 : 0);
    }

    window.onload = popularAtivos;
</script>
</body>
</html>
