<meta name='viewport' content='width=device-width, initial-scale=1'/><!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Aviator Pro - Sniper Edition</title>
    <style>
        :root {
            --aviator-azul: #3498db; --aviator-roxo: #9b59b6; --aviator-rosa: #e91e63;
            --cor-verde: #0ecb81; --cor-vermelha: #d91d3a; --cor-alerta: #f39c12;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; font-family: 'Arial Black', sans-serif; }
        body { background: #000; display: flex; flex-direction: column; align-items: center; height: 92vh; overflow: hidden; color: white; }

        .topo-info { display: flex; width: 100%; height: 40px; background: #111; border-bottom: 2px solid #333; }
        .placar-geral { width: 50%; display: flex; justify-content: center; align-items: center; gap: 15px; font-size: 1.1rem; border-right: 1px solid #333; }
        .placar-g-geral { color: var(--cor-verde); } .placar-r-geral { color: var(--cor-vermelha); }
        .cronometro-box { width: 50%; display: flex; justify-content: center; align-items: center; gap: 10px; font-size: 1.1rem; }

        .calculadora {
            width: 95vw; max-width: 460px; height: 95vh; background: #1a1a1a;
            border-radius: 20px; border: 2px solid #333; padding: 8px;
            display: flex; flex-direction: column; position: relative;
        }

        .stage-animacao {
            width: 100%; height: 180px; background: radial-gradient(circle at bottom, #1a0a2e 0%, #000 100%);
            border-radius: 12px; margin-bottom: 8px; position: relative; overflow: hidden; border: 1px solid #333;
        }
        #svg-grafico { position: absolute; bottom: 0; left: 0; width: 100%; height: 100%; overflow: visible; }
        #curva-line { fill: none; stroke: var(--cor-vermelha); stroke-width: 5; stroke-linecap: round; transition: d 1.5s cubic-bezier(0.1, 0, 0.3, 1), stroke 0.3s, opacity 0.4s; opacity: 0; }
        #curva-fill { fill: url(#grad); opacity: 0; transition: d 1.5s cubic-bezier(0.1, 0, 0.3, 1), opacity 0.4s; }
        
        #rocket-box { position: absolute; width: 45px; height: 45px; left: 10px; bottom: 0px; z-index: 30; display: flex; align-items: center; justify-content: center; font-size: 35px; transition: all 1.5s cubic-bezier(0.1, 0, 0.3, 1); filter: grayscale(1); opacity: 0; }
        
        .no-transition { transition: none !important; }
        .fly-away { transform: translate(500px, -500px) rotate(-20deg) scale(1.2) !important; opacity: 0 !important; transition: transform 0.7s cubic-bezier(0.4, 0, 1, 1), opacity 0.4s !important; }

        .grade { display: grid; grid-template-columns: repeat(7, 1fr); gap: 4px; margin-bottom: 8px; min-height: 56px; }
        .vela { background: #222; border-radius: 4px; display: flex; align-items: center; justify-content: center; font-size: 0.85rem; font-weight: bold; height: 26px; border: 0.5px solid #444; color: white; }
        .v-azul { background: #003247 !important; } .v-roxo {background: #6441a5 !important; } .v-rosa {background: #bf279b !important; }

        .painel-status { text-align: center; padding: 8px; background: #000; border-radius: 10px; border: 1px solid #333; margin-bottom: 8px; }
        #status-display { color: var(--cor-verde); font-weight: bold; font-size: 1.2rem; text-transform: uppercase; }

        .visor { background: #000; border: 1px solid #444; border-radius: 8px; height: 32px; display: flex; align-items: center; justify-content: center; color: var(--cor-verde); font-size: 1.2rem; }

        .teclado-grid { display: grid; grid-template-columns: repeat(3, 1fr) 1.2fr; gap: 5px; }
        .btn-n { background: #333; color: white; border: none; border-radius: 8px; font-size: 1.5rem; cursor: pointer; height: 42px; }
        .btn-c { background: var(--cor-vermelha); color: white; border: none; border-radius: 8px; font-size: 1.5rem; cursor: pointer; }
        .btn-acao { border: none; border-radius: 8px; font-weight: bold; cursor: pointer; text-transform: uppercase; color: white; font-size: 0.75rem; }
        .btn-entrar { grid-row: span 2; background: var(--cor-verde); color: #000; font-size: 1.1rem; }

        .tendencia-box { background: #000; padding: 5px 12px; border-radius: 8px; margin-bottom: 8px; display: flex; justify-content: space-between; border-left: 4px solid var(--aviator-azul); align-items: center;}
        
        .tab-content { display: none; flex-direction: column; height: 100%; padding: 10px; overflow-y: auto; }
        .tab-content.active { display: flex; }
        
        #modal-config { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.95); z-index: 3000; display: none; flex-direction: column; padding: 20px; }
    </style>
</head>
<body onload="carregarTudo()">

<div class="topo-info">
    <div class="placar-geral">
        <div class="placar-g-geral">G: <span id="count-g-geral">0</span></div>
        <div class="placar-r-geral">R: <span id="count-r-geral">0</span></div>
    </div>
    <div class="cronometro-box">
        <span onclick="toggleCrono()" id="btn-crono" style="cursor:pointer">‚ñ∂Ô∏è</span>
        <span id="display-crono">00:00:00</span>
    </div>
</div>

<div class="calculadora">
    <div id="tab-calc" class="tab-content active" style="padding:0">
        <div class="tendencia-box">
            <div><small style="color:#888; font-size: 0.7rem;">TEND√äNCIA</small><br><span id="tend-txt" style="font-size: 0.9rem;">EST√ÅVEL</span></div>
            <div style="text-align: right;"><small style="color:#888; font-size: 0.7rem;">FOR√áA G</small><br><span id="tend-forca" style="color:var(--cor-verde); font-size: 0.9rem;">0%</span></div>
            <button onclick="abrirConfig()" style="background:none; border:none; color:white; font-size: 1rem;">‚öôÔ∏è</button>
        </div>

        <div class="stage-animacao">
            <svg id="svg-grafico" viewBox="0 0 300 120">
                <defs>
                    <linearGradient id="grad" x1="0%" y1="0%" x2="0%" y2="100%">
                        <stop offset="0%" id="stop-top" style="stop-color:var(--cor-vermelha);stop-opacity:0.6" />
                        <stop offset="100%" style="stop-color:var(--cor-vermelha);stop-opacity:0" />
                    </linearGradient>
                </defs>
                <path id="curva-fill" d="M 0 120 Q 150 130 280 40"></path>
                <path id="curva-line" d="M 0 120 Q 150 130 280 40"></path>
            </svg>
            <div id="rocket-box">üöÄ</div>
        </div>

        <div class="painel-status">
            <span id="status-display">SISTEMA ATIVO</span>
        </div>

        <div class="grade" id="grade"></div>

        <div style="display: flex; gap: 5px; margin-bottom: 8px;">
            <div class="visor" id="visor-val" style="flex: 1;">0.00</div>
            <div id="msg-analisador-azul" style="flex: 1.8; background: #0000ff; border-radius: 8px; display: flex; align-items: center; justify-content: center; font-size: 0.75rem; font-weight: bold; padding: 4px; text-align: center; color: white; transition: background 0.3s;">
                AGUARDANDO DADOS...
            </div>
        </div>

        <div class="teclado-grid">
            <button class="btn-n" onclick="add('7')">7</button>
            <button class="btn-n" onclick="add('8')">8</button>
            <button class="btn-n" onclick="add('9')">9</button>
            <button class="btn-acao" style="background:#444" onclick="abrirVisor()">VISOR</button>
            
            <button class="btn-n" onclick="add('4')">4</button>
            <button class="btn-n" onclick="add('5')">5</button>
            <button class="btn-n" onclick="add('6')">6</button>
            <button class="btn-acao" style="background:#ff0000" onclick="abrirInfo()">INFO</button>
            
            <button class="btn-n" onclick="add('1')">1</button>
            <button class="btn-n" onclick="add('2')">2</button>
            <button class="btn-n" onclick="add('3')">3</button>
            <button class="btn-acao btn-entrar" onclick="confirmar()">ENTRAR</button>
            
            <button class="btn-c" onclick="limpar()">C</button>
            <button class="btn-n" onclick="add('0')">0</button>
            <button class="btn-n" onclick="add('.')">.</button>
            
            <button class="btn-acao" style="background:#007bff; grid-column: span 3; height: 40px;" onclick="abrirHistorico()">VER HIST√ìRICO</button>
            <button class="btn-acao" style="background:#c0392b; height: 40px;" onclick="apagarDadosGerais()">DEL</button>
        </div>
    </div>

    <div id="tab-grade-inf" class="tab-content"><button class="btn-n" style="margin-bottom:10px; width:100%" onclick="switchTab('calc')">VOLTAR</button><div id="grade-completa-infinita" style="display:grid; grid-template-columns:repeat(5,1fr); gap:5px;"></div></div>
    <div id="tab-hist" class="tab-content"><button class="btn-n" style="margin-bottom:10px; width:100%" onclick="switchTab('calc')">VOLTAR</button><div id="lista-greens-layout"></div></div>
    <div id="tab-analise" class="tab-content"><button class="btn-n" style="margin-bottom:10px; width:100%" onclick="switchTab('calc')">VOLTAR</button><div id="sugestao-final" style="background:#222; padding:15px; border-radius:10px; line-height:1.6"></div></div>

    <div id="modal-config">
        <h3 style="text-align:center">Configurar Padr√µes</h3>
        <div id="lista-config" style="flex:1; overflow-y:auto; margin: 15px 0;"></div>
        <input type="text" id="novo-p-input" placeholder="Ex: PPG" style="padding:10px; margin-bottom:10px">
        <button onclick="salvarNovoPadrao()" style="background:var(--cor-verde); padding:10px; border:none; margin-bottom:5px">ADICIONAR</button>
        <button onclick="fecharConfig()" style="background:var(--cor-vermelha); padding:10px; border:none">FECHAR</button>
    </div>
</div>

<script>
    let historico = [], logSinais = [], digitacao = "", sinalAtivo = false, meusPadroes = [], totalGreenGeral = 0, totalRedGeral = 0;
    let tempoSeg = 0, cronoInterval = null, galeAtual = 0;

    function setMsgAux(txt, cor) {
        const box = document.getElementById('msg-analisador-azul');
        box.innerText = txt; 
        box.style.background = cor;
    }

    function confirmar() {
        if(!digitacao || digitacao === "0.00") return;
        const v = parseFloat(digitacao);
        const t = v >= 2.0 ? 'G' : 'P';
        let cl = v < 2.0 ? 'v-azul' : (v < 10.0 ? 'v-roxo' : 'v-rosa');
        const hora = new Date().toLocaleTimeString();
        
        // Adiciona ao hist√≥rico
        historico.unshift({v: v.toFixed(2), t: t, c: cl, h: hora});

        if(sinalAtivo) {
            if(v >= 1.50) { 
                totalGreenGeral++; sinalAtivo = false; animarRocket('finish', 'var(--cor-verde)');
                setStatus("GREEN! ‚úÖ", "var(--cor-verde)");
                setMsgAux("GREEN NO ALVO!", "var(--cor-verde)");
                logSinais.unshift({res: 'GREEN', val: v, gale: galeAtual, hora: hora});
            } else {
                galeAtual++;
                if (galeAtual > 1) {
                    totalRedGeral++; sinalAtivo = false; animarRocket('finish', 'var(--cor-vermelha)'); 
                    setStatus("RED ‚ùå", "var(--cor-vermelha)");
                    setMsgAux("LIMITE GALE EXCEDIDO", "var(--cor-vermelha)");
                    logSinais.unshift({res: 'RED', val: v, gale: galeAtual-1, hora: hora});
                } else { 
                    animarRocket('voo', 'var(--cor-alerta)');
                    setStatus(`üö® GALE ${galeAtual}`, "var(--cor-alerta)"); 
                    setMsgAux("FAZER GALE 1", "var(--cor-alerta)");
                }
            }
        } else {
            verificarPadroes();
        }
        
        document.getElementById('count-g-geral').innerText = totalGreenGeral;
        document.getElementById('count-r-geral').innerText = totalRedGeral;
        renderGrade(); 
        atualizarTendencia(); 
        limpar();
    }

    function verificarPadroes() {
        if(historico.length < 2) return;
        const seq = historico.map(h => h.t).join('');
        let achouPadrao = false;
        
        const textoForca = document.getElementById('tend-forca').innerText;
        const valorForca = parseInt(textoForca.replace('%', '')) || 0;

        meusPadroes.forEach(item => {
            if(seq.startsWith(item.p)) {
                achouPadrao = true;
                if(valorForca >= 40) {
                    sinalAtivo = true; galeAtual = 0;
                    setStatus("ENTRAR: 1.50x üöÄ", "var(--cor-alerta)");
                    setMsgAux("SINAL CONFIRMADO", "var(--cor-alerta)");
                    animarRocket('voo');
                } else {
                    setStatus("FOR√áA G BAIXA", "var(--cor-vermelha)");
                    setMsgAux("AGUARDANDO "+valorForca+"% < 40%", "var(--cor-vermelha)");
                }
            }
        });

        if(!achouPadrao && !sinalAtivo) {
            setStatus("ANALISANDO...", "var(--cor-verde)");
            setMsgAux("ANALISANDO MERCADO", "#0000ff");
        }
    }

    function renderGrade() {
        const g = document.getElementById('grade');
        g.innerHTML = '';
        for(let i=0; i<14; i++) {
            if(historico[i]) {
                const velaDiv = document.createElement('div');
                velaDiv.className = `vela ${historico[i].c}`;
                velaDiv.innerText = historico[i].v;
                g.appendChild(velaDiv);
            } else {
                const vazioDiv = document.createElement('div');
                vazioDiv.className = 'vela';
                g.appendChild(vazioDiv);
            }
        }
    }

    function atualizarTendencia() {
        if(historico.length < 3) return;
        const ultimas10 = historico.slice(0, 10);
        const greens = ultimas10.filter(h => parseFloat(h.v) >= 2.0).length;
        const forca = greens * 10;
        
        const fDisplay = document.getElementById('tend-forca');
        fDisplay.innerText = forca + "%";
        fDisplay.style.color = forca >= 40 ? "var(--cor-verde)" : "var(--cor-vermelha)";
        
        document.getElementById('tend-txt').innerText = forca > 60 ? "ALTA" : (forca < 30 ? "BAIXA" : "EST√ÅVEL");
    }

    // --- FUN√á√ïES DE SUPORTE ---
    function carregarTudo() {
        const s = localStorage.getItem('aviator_p_v4');
        meusPadroes = s ? JSON.parse(s) : [{p: "PPG"}];
        renderGrade();
    }
    function add(n) { if(digitacao.length < 5) { digitacao += n; document.getElementById('visor-val').innerText = digitacao; } }
    function limpar() { digitacao = ""; document.getElementById('visor-val').innerText = "0.00"; }
    function setStatus(txt, cor) { const s = document.getElementById('status-display'); s.innerText = txt; s.style.color = cor; }
    function switchTab(t) { document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active')); document.getElementById('tab-'+t).classList.add('active'); }
    function abrirVisor() { switchTab('grade-inf'); document.getElementById('grade-completa-infinita').innerHTML = historico.map(h => `<div class="vela ${h.c}">${h.v}</div>`).join(''); }
    function abrirHistorico() { switchTab('hist'); document.getElementById('lista-greens-layout').innerHTML = logSinais.map(l => `<div style="background:#222; padding:8px; margin-bottom:5px; border-radius:5px; border-left:4px solid ${l.res==='GREEN'?'green':'red'}"><b>[${l.res}]</b> ${l.val}x - Gale ${l.gale}</div>`).join('') || 'Sem sinais.'; }
    function abrirInfo() { switchTab('analise'); const total = totalGreenGeral+totalRedGeral; const assert = total>0?((totalGreenGeral/total)*100).toFixed(1):0; document.getElementById('sugestao-final').innerHTML = `ASSERTIVIDADE: ${assert}%<br>GREENS: ${totalGreenGeral}<br>REDS: ${totalRedGeral}`; }
    function toggleCrono() { if(cronoInterval){clearInterval(cronoInterval); cronoInterval=null;} else {cronoInterval=setInterval(()=>{tempoSeg++; let h=Math.floor(tempoSeg/3600).toString().padStart(2,'0'), m=Math.floor((tempoSeg%3600)/60).toString().padStart(2,'0'), s=(tempoSeg%60).toString().padStart(2,'0'); document.getElementById('display-crono').innerText=`${h}:${m}:${s}`;},1000);}}
    function apagarDadosGerais() { if(confirm("Limpar tudo?")){historico=[]; logSinais=[]; totalGreenGeral=0; totalRedGeral=0; document.getElementById('count-g-geral').innerText=0; document.getElementById('count-r-geral').innerText=0; renderGrade();}}
    function abrirConfig() { document.getElementById('modal-config').style.display='flex'; renderConfig(); }
    function fecharConfig() { document.getElementById('modal-config').style.display='none'; }
    function renderConfig() { const l = document.getElementById('lista-config'); l.innerHTML = meusPadroes.map((p,i)=>`<div style="display:flex; justify-content:space-between; margin-bottom:5px; background:#222; padding:8px;"><span>${p.p}</span><button onclick="meusPadroes.splice(${i},1);renderConfig();localStorage.setItem('aviator_p_v4', JSON.stringify(meusPadroes))" style="background:red; color:white; border:none; padding:2px 8px;">X</button></div>`).join(''); }
    function salvarNovoPadrao() { const val = document.getElementById('novo-p-input').value.toUpperCase().replace(/[^PG]/g, ''); if(val){meusPadroes.push({p:val}); renderConfig(); localStorage.setItem('aviator_p_v4', JSON.stringify(meusPadroes)); document.getElementById('novo-p-input').value='';}}
    
    function animarRocket(estado, cor='red') {
        const box = document.getElementById('rocket-box');
        const line = document.getElementById('curva-line');
        if(estado==='voo'){
            box.classList.remove('no-transition','fly-away'); box.style.opacity="1"; line.style.opacity="1";
            box.style.left='269px'; box.style.bottom='100px'; line.style.stroke=cor;
        } else {
            setTimeout(()=>{box.classList.add('fly-away'); setTimeout(()=>{box.classList.add('no-transition'); box.style.opacity="0"; box.style.left='10px'; box.style.bottom='0px'; line.style.opacity="0";},700);},500);
        }
    }
</script>
</body>
</html>
